# LES EVENEMENTS EN JAVASCRIPT

## CONTEXTE

Un Ã©vÃ©nement est un signal invisible liÃ© Ã  une action de lâ€™utilisateur dans le navigateur.

Le principe dâ€™Ã©vÃ¨nements en JavaScript est inhÃ©rent au DOM, le principe Ã©tant de dynamiser la page aprÃ¨s que lâ€™utilisateur ait interagi avec celle-ci.

## FONCTIONNEMENT

Les Ã©vÃ¨nements javascript se dÃ©composent en 3 Ã©tapes :

- Lâ€™Ã©coute
- Le signal
- Lâ€™action

Chaque Ã©vÃ©nement Ã©met un signal qui est captÃ© par le navigateur qui est ensuite interprÃ©tÃ© par le code JavaScript.

Par exemple, dans le cadre dâ€™une messagerie instantanÃ©e, lâ€™Ã©coute serait placÃ©e sur lâ€™icÃ´ne de corbeille, le signal correspond au clic de lâ€™utilisateur sur lâ€™icÃ´ne et l'action serait la suppression du message associÃ©.

![alt img68](/images/courses/level1/img68.png)


***Step-by-step***

**Cibler l'Ã©lÃ©ment Ã  Ã©couter**

Pour capter le signal Ã©mis, la premiÃ¨re Ã©tape consiste Ã  cibler lâ€™Ã©lÃ©ment HTML que lâ€™on souhaite Ã©couter. 
Par exemple en ciblant son identifiant :

```index.html```

```html
<body>
 <ul>
   <li id="t1">Go to ğŸ‘</li>
   <li id="t2">Lesson ğŸ¾</li>
 </ul>
</body>
```

```script.js```

```js
document.querySelector('#t1');
```

***Mettre lâ€™Ã©lÃ©ment sur Ã©coute***

Cette seconde Ã©tape consiste Ã  ajouter la mÃ©thode addEventListener() qui permet de mettre sur Ã©coute un ou plusieurs Ã©lÃ©ments HTML.

```js
document.querySelector('#t1').addEventListener();
```

***Choisir un signal***

La mÃ©thode ```addEventListener()``` ne fonctionne pas seule, il faut lui indiquer le type de signal Ã  surveiller 
(un clic, un scroll, une saisie sur le clavier, le survol dâ€™un Ã©lÃ©mentâ€¦) qui dÃ©clenchera l'Ã©vÃ©nement Ã  rÃ©aliser.

```js
document.querySelector('#t1').addEventListener('click');
```

***DÃ©finir lâ€™action Ã  effectuer***
La fonction de callback de la mÃ©thode ```addEventListener``` se dÃ©clenche dÃ¨s que le signal surveillÃ© se produit, 
elle indique le traitement Ã  effectuer en rÃ©ponse Ã  cet Ã©vÃ¨nement.

```js
document.querySelector('#t1').addEventListener('click',

  function () {
   console.log('Click detected!');
 }
);
```

Dans notre exemple, on souhaite effectuer un ```console.log``` avec le message **â€œclick dÃ©tected !â€** 
dÃ¨s que lâ€™utilisateur clique sur la balise portant lâ€™id â€œt1â€..

## Lâ€™ASYNCHRONIE

Par dÃ©faut le code s'exÃ©cute de faÃ§on synchrone, les lignes sont automatiquement lues les unes aprÃ¨s les autres .

Cependant, il est parfois nÃ©cessaire dâ€™attendre le rÃ©sultat dâ€™une ligne pour pouvoir lire la suivante. 
Câ€™est le cas des lignes qui se trouvent dans la fonction de callback dâ€™un Ã©vÃ©nement. 
Elles doivent s'exÃ©cuter uniquement lors de la remontÃ©e dâ€™un signal, on parle alors d'exÃ©cution asynchrone de cette tÃ¢che.

Dans lâ€™exemple ci-dessous, l'Ã©vÃ©nement se base sur le click sur la balise portant lâ€™id â€œt1â€.

```js
console.log('Start');

document.querySelector('#t1').addEventListener('click',
 function (){
   console.log('Click detected!');
 }
);

console.log('End');
```

Les ```console.log()``` permettent dâ€™illustrer le principe d'asynchronie qui sera visible dans la console.

***Au chargement du script***

![alt img69](/images/courses/level1/img69.png)

***AprÃ¨s le clic sur l'Ã©vÃ©nement***

![alt img70](/images/courses/level1/img70.png)

## ECOUTER PLUSIEURS ELEMENTS

Imaginons que nous souhaitions mettre sur Ã©coute plusieurs Ã©lÃ©ments.

```js
<body>
 <ul>
   <li id="t1">Go to ğŸ‘</li>
   <li id="t2">Lesson ğŸ¾</li>
 </ul>
</body>
```

Pour mettre sur Ã©coute plusieurs Ã©lÃ©ments vous devez passer par une boucle qui passe sur 
lâ€™ensemble des balises que vous souhaitez surveiller. Par exemple toutes les balises ```<li>```:

```js
for (let i = 0; i < document.querySelectorAll('li').length; i++) {
 document.querySelectorAll('li')[i].addEventListener('click',
   function () {
     console.log('Click detected on <li>');
   }
 );
}
``

## L'OPERATEUR THIS

En factorisant le traitement avec une boucle, nous avons perdu une information essentielle : 
celle de connaÃ®tre quel Ã©lÃ©ment a Ã©tÃ© cliquÃ©.

Lorsquâ€™on clique sur un paragraphe, lâ€™information sâ€™affiche dans la console mais nous ne 
sommes plus capables de connaÃ®tre lâ€™Ã©lÃ©ment sÃ©lectionnÃ©.

La mÃ©thode ```addEventListener()``` propose un opÃ©rateur afin dâ€™identifier directement 
dans la fonction de callback lâ€™Ã©lÃ©ment Ã©coutÃ© : ```this```.

```js
for (let i = 0; i < document.querySelectorAll('li').length; i++) {
 document.querySelectorAll('li')[i].addEventListener('click',
   function () {
     console.log(this);
   }
 );
}
```

***AprÃ¨s le clic sur un Ã©lÃ©ment de la liste***

![alt img71](/images/courses/level1/img71.png)

De faÃ§on gÃ©nÃ©rale, lâ€™opÃ©rateur â€œthisâ€ fait rÃ©fÃ©rence au contexte qui lâ€™englobe.
